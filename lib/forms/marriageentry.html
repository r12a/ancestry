<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Marriage form</title>
<link href="../../lib/style.css" rel="stylesheet">
<style>
td { vertical-align: top; padding-left: 1em; }
details { margin-left: 2em; }
</style>
<script src="formentrylookup.js"></script>
<script src="getplacenames.js"></script>
<script>
trace = false

// read in project
var project = ''
var theperson = ''

// get any parameter info
console.log(location.search)
const params = new URLSearchParams(location.search)
console.log(params)
console.log('proj',params.get('project'))
console.log('proj',params.get('theperson'))
project = params.get('project')
theperson = params.get('person')
spouse = params.get('spouse')

if (project === null) project = prompt('What project do you want to work with?')
if (theperson === null) theperson = prompt('Provide the id of the first person.')


/*
?project=all&person=keam_peter_1816&spouse=tank_jane_1821



parameters = location.search.split('&');
parameters[0] = parameters[0].substring(1);
for (var p=0;p<parameters.length;p++) {  
	pairs = parameters[p].split('=');
	if (pairs[0] == 'project') { if (pairs[1]) { project = pairs[1] } }
	if (pairs[0] == 'person' && pairs[1]) { theperson = pairs[1] }
	}

console.log(project, theperson)

// get project & ids	
if (project === '' || project.match(/\.\./)) {
    project = prompt('What project do you want to work with?')
    }
if (theperson == '') {
    theperson = prompt('Provide the id of the first person.')
    }

window.location += '?project='+project+'&person='+theperson
*/


// load the appropriate db file	
var db = document.createElement('script')
db.id = 'database'
db.src = '../../'+project+'/db.js'
db.async = false
document.head.appendChild(db);


// load the appropriate census file	
var db = document.createElement('script')
db.src = '../../'+project+'/census.js'
db.async = false
document.head.appendChild(db)







if (theperson) {
    setTimeout(() => autoPropagate(theperson), 1000)
    }
</script>




<script>

function openWindow (locn) {
    const windowFeatures = "left=50,top=50";
	//var newwindow = window.open(locn, 'newwindow', windowFeatures) 
	var newwindow = window.open(locn, 'newwindow') 
	newwindow.focus()
	}

function openRecord (locn, ext) {
	var newwindow = window.open('../../'+project+'_records/'+locn+ext, 'newwindow') 
	output.focus()
	newwindow.focus()
	}

function makeNotes (content, target) {
	segments = content.split('\n')
	var out = 'fnotes: ['
	for (var i=0;i<segments.length;i++) out += '"'+segments[i]+'", '
    out += '],'
	document.getElementById(target).textContent = out
	}










function autoPropagate (person) {
    // Pull up a list of ids for related people, and fill in some fields automatically
    if (person === '') {
        alert('No id provided.')
        return
        }

    // add id for parameter driven use
    document.getElementById('idIn').value = person

    // populate the places datalist
    findallplaces()
    makePlacesDatalist()


    // make a list of relatives to the right
	listRelations(person)



    // first find the marriage data
    var spouse = document.getElementById('spouseIdIn').value
    /*if (spouse === '') {
        alert('Spouse id needed to autopropate data.')
        return
        }*/
    if (spouse === '') {
        // get any known spouses
        if (db[person] && db[person].fg) {
            fgArray = db[person].fg
            listOfSpouses = ''
            for (s=0;s<fgArray.length;s++) listOfSpouses += fgArray[s][1]+'\n'
            if (fgArray.length > 0) listOfSpouses = 'Known spouses:\n'+listOfSpouses+'\n'
            }
        spouse = prompt(listOfSpouses+'Provide the id of the spouse.')
        document.getElementById('spouseIdIn').value = spouse
        }

    var dataItems
    if (db[person] && db[person].marriages && db[person].marriages[spouse]) dataItems = db[person].marriages[spouse]
    else if (db[spouse] && db[spouse].marriages && db[spouse].marriages[person]) dataItems = db[spouse].marriages[person]
    
    console.log(dataItems)
    
    if (dataItems === null) {
        alert("Marriage data not found for this couple.")
        return
        }
   
    


    // fill in name fields from the db
	if (db[person]) {
		// get this person's name and id
		if (db[person].male) {
			document.getElementById('groomIn').value = db[person].g+' '+db[person].f
			document.getElementById('gidIn').value= person
			}
		else {
			document.getElementById('brideIn').value = db[person].g+' '+db[person].f
			document.getElementById('bidIn').value= person
			}

		if ((fid = db[person].father) && db[person].male) {
			if (db[fid]) {
                document.getElementById('gfidIn').value = fid
			    document.getElementById('gfatherIn').value = db[fid].g+' '+db[fid].f
                }
            else document.getElementById('gfatherIn').value = db[person].father
			}
		if ((fid = db[person].father) && ! db[person].male) {
			if (db[fid]) {
                document.getElementById('bfidIn').value = fid;
                document.getElementById('bfatherIn').value = db[fid].g+' '+db[fid].f
                }
            else document.getElementById('bfatherIn').value = db[person].father
			}
        }



	if (db[spouse]) {
		// get this person's name and id
		if (db[spouse].male) {
			document.getElementById('groomIn').value = db[spouse].g+' '+db[spouse].f
			document.getElementById('gidIn').value= spouse
			}
		else {
			document.getElementById('brideIn').value = db[spouse].g+' '+db[spouse].f
			document.getElementById('bidIn').value= spouse
			}
        // get their father's name & id
		if ((fid = db[spouse].father) && db[spouse].male) {
			if (db[fid]) {
                document.getElementById('gfidIn').value = fid
                document.getElementById('gfatherIn').value = db[fid].g+' '+db[fid].f
			    }
            else document.getElementById('gfatherIn').value = db[spouse].father
            }
		if ((fid = db[spouse].father) && ! db[spouse].male) {
			if (db[fid]) {
                document.getElementById('bfidIn').value = fid
			    document.getElementById('bfatherIn').value = db[fid].g+' '+db[fid].f
                }
            else document.getElementById('bfatherIn').value = db[spouse].father
			}
        }

    // insert existing data from db
    if (dataItems) {
        var notes = ''
        var fnotes = ''
        var discussion = ''
        
        if (dataItems.timestamp) document.getElementById('timestampIn').value = dataItems.timestamp.trim()

        if (dataItems.year) document.getElementById('yearIn').value = dataItems.year.trim()

        if (dataItems.date) document.getElementById('dateIn').value = dataItems.date.trim()

        if (dataItems.place) document.getElementById('marrPlaceIn').value = dataItems.place.trim()

        if (dataItems.groom) document.getElementById('groomIn').value = dataItems.groom.trim()

        if (dataItems.gid) document.getElementById('gidIn').value = dataItems.gid.trim()

        if (dataItems.bride) document.getElementById('brideIn').value = dataItems.bride.trim()

        if (dataItems.bid) document.getElementById('bidIn').value = dataItems.bid.trim()

        if (dataItems.gage) document.getElementById('gageIn').value = dataItems.gage.trim()

        if (dataItems.bage) document.getElementById('bageIn').value = dataItems.bage.trim()

        if (dataItems.gparish) document.getElementById('gparishIn').value = dataItems.gparish.trim()

        if (dataItems.bparish) document.getElementById('bparishIn').value = dataItems.bparish.trim()

        if (dataItems.gstatus) document.getElementById('gstatusIn').value = dataItems.gstatus.trim()

        if (dataItems.bstatus) document.getElementById('bstatusIn').value = dataItems.bstatus.trim()

        if (dataItems.gocc) document.getElementById('goccIn').value = dataItems.gocc.trim()

        if (dataItems.bocc) document.getElementById('boccIn').value = dataItems.bocc.trim()

        if (dataItems.gfocc) document.getElementById('gfoccIn').value = dataItems.gfocc.trim()

        if (dataItems.bfocc) document.getElementById('bfoccIn').value = dataItems.bfocc.trim()

        if (dataItems.witnesses) document.getElementById('witnessesIn').value = dataItems.witnesses.trim()

        if (dataItems.mentioned) document.getElementById('mentionedIn').value = dataItems.mentioned.trim()

        if (dataItems.by) document.getElementById('byIn').value = dataItems.by.trim()




        
        if (dataItems.denomination) document.getElementById('denominationIn').value = dataItems.denomination.trim()

        if (dataItems.gps) {
            out = ''
            for (i=0;i<dataItems.gps.length;i++)  out += `${ dataItems.gps[i].replace(/ https:\/\/maps.google.com\/maps\?q=/,':') }\n`
            document.getElementById('gpsIn').value = out
            }


         if (dataItems.images) {
            out = ''
            for (i=0;i<dataItems.images.length;i++)  out += `${ dataItems.images[i].replace(/url:records\//,'') }\n`
            document.getElementById('recordsIn').value = out
            }
        
        
        if (dataItems.discussion) document.getElementById('censusDisc').value = dataItems.discussion.trim()
        
        if (dataItems.caution) document.getElementById('cautionIn').value = dataItems.caution.trim()
       
    // get sources
    if (dataItems.sources) {
        formatSource(dataItems.sources, '')
        }
        
        draftResult()
        }
	}


function formatSource (sources, discussion) {
    // wrap source lines in link markup
    if (trace) console.log(enter, 'formatSource(',sources,')')

    if (typeof sources === 'undefined') return ''
    
    var sourceList = sources.split('SOURCE:')
    //console.log(sourceList)
    
    var counter = 0
    for (s=0;s<sourceList.length;s++) {
        if (sourceList[s].trim() === '') continue
        
        // assign the output area names
        switch (counter) {
            case 0: target = 'index'; break
            case 1: target = 'bap'; break
            case 2: target = 'second'; break
            case 3: target = 'third'; break
            }
        counter++
        console.log(target, sourceList[s])
    
        var lines = sourceList[s].split('\n')
        for (var i=0;i<lines.length;i++) {
            if (lines[0].includes('http')) {
                parts = lines[0].split('http')
                document.getElementById(target+'SourceIn').value = parts[0].trim()
                document.getElementById(target+'SourceURLIn').value = `http${ parts[1]}`
                body = ''
                for (j=1;j<lines.length;j++) body += lines[j]+'\n'
                document.getElementById(target+'PastedIn').value = body
                document.getElementById(target).open = true
                }
            else if (lines[i].match('SOURCE') && lines[i].match('url:')) {
                parts = lines[i].split('url:')
                parts[0] = parts[0].replace(/SOURCE: /,'')
                lines[i] = `<img src="lib/i/source.png" alt="Source link" title="Source link"><a target="_blank" href="${ window.project }/${ parts[1] }">${ parts[0] }</a>`
                }
            else {
                title = lines[0].replace(/SOURCE: /,'')
                document.getElementById(target+'SourceIn').value = title.trim()
                body = ''
                for (j=1;j<lines.length;j++) body += lines[j]+'\n'
                document.getElementById(target+'PastedIn').value = body
                document.getElementById(target).open = true
                }
            }
            }
    
    sources = lines.join('\n').replace(/\[|\]/g,'')
    
    console.log(sources)
    //if (discussion) sources += '\n<img src="lib/i/discn.png" alt="Commentary" title="Commentary">'+discussion
    
    if (trace) console.log(exit,'formatSource:',sources)
    return sources
    }




function addQuotesTo (content) { 
    // quotes no longer needed. Just normalisation of lines.
	var out = ''
	var lines = content.split('\n')
	for (var i=0;i<lines.length;i++) {
        if (! lines[i].includes(':')) lines[i] = lines[i].replace(/\t/,': ')
        lines[i] = lines[i].replace(/\s+/g,' ')
		out += lines[i].trim()
        if (i<lines.length-1) out += '\n'
		}
	return out
	}



function clearAll () {
	inputs = document.querySelectorAll('input, textarea')
	for (var i=0;i<inputs.length;i++) inputs[i].value = ''
	
	divs =  document.getElementById('draft').querySelectorAll('div')
	for (i=0;i<divs.length;i++) divs[i].textContent = ''
	document.getElementById('discussion').textContent = '"discussion: "'
	document.getElementById('start').textContent = "\"marriage\": ["
	document.getElementById('end').textContent = "]"
	}


function formatGPS (str) {
	str = str.replace(/https:\/\/maps.google.com\/maps\?q=/,'')
	str = str.trim().replace(/,/,' ').replace(/\s+/,',')
	return str
	}
</script>
<style>
#draft p {
	margin: 0;
	}
#references, #certificateTemplate, #parishTemplate {
    clear: right;
	font-size: 80%;
	float: right;
    margin-block-start: 4rem;
	}
#references p, #certificateTemplate p, #parishTemplate p {
	margin: 0;
	}
#references h3, #certificateTemplate h3, #parishTemplate h3 {
	margin-bottom: 0;
	}
.redo { font-size:120%; margin-left: 1em; cursor: pointer; }
.copy { margin-left: 2em; cursor: pointer; background-color: rgba(107,167,227,1.00); color: white; border-radius: 5px; }
.copy:hover { background-color: rgba(11,124,236,1.00); color: white; border-radius: 5px; }
.accept:hover { background-color: rgba(11,124,236,1.00); color: white; border-radius: 5px; }
.heading { font-weight:bold; padding-top: 1em; font-size: 110%; }
</style>






<script>

function draftResult () {
    // called each time a field is changed; updates the output
    

// index
    if (document.getElementById('indexSourceIn').value.trim() || document.getElementById('indexSourceURLIn').value.trim())
        document.getElementById('indexSource').textContent = `SOURCE: ${ document.getElementById('indexSourceIn').value.trim() }  ${ document.getElementById('indexSourceURLIn').value.trim() },` 
    else document.getElementById('indexSource').textContent = ''
    
    if (document.getElementById('indexPastedIn').value.trim()) 
        document.getElementById('indexPasted').textContent = addQuotesTo(document.getElementById('indexPastedIn').value.trim())
    else document.getElementById('indexPasted').textContent = ''
    
    if (document.getElementById('indexTextIn').value.trim()) 
        document.getElementById('indexText').textContent = `text: ${ document.getElementById('indexTextIn').value.trim() }`
    else document.getElementById('indexText').textContent = ''
 
    
    if (document.getElementById('spouseIdIn').value.trim()) document.getElementById('spouseId').textContent = `"${ document.getElementById('spouseIdIn').value.trim() }": {` 
    else document.getElementById('spouseId').textContent = 'TBD: {'



// second source
    if (document.getElementById('secondSourceIn').value.trim() || document.getElementById('secondSourceURLIn').value.trim())
        document.getElementById('secondSource').textContent = `SOURCE: ${ document.getElementById('secondSourceIn').value.trim() }  ${ document.getElementById('secondSourceURLIn').value.trim() }` 
    else document.getElementById('secondSource').textContent = ''

    if (document.getElementById('secondPastedIn').value.trim()) 
        document.getElementById('secondPasted').textContent = addQuotesTo(document.getElementById('secondPastedIn').value.trim())
    else document.getElementById('secondPasted').textContent = ''
 
    if (document.getElementById('secondTextIn').value.trim()) 
        document.getElementById('secondText').textContent = `text: ${ document.getElementById('secondTextIn').value.trim() }`
    else document.getElementById('secondText').textContent = ''




// third source
    if (document.getElementById('thirdSourceIn').value.trim() || document.getElementById('thirdSourceURLIn').value.trim())
        document.getElementById('thirdSource').textContent = `\nSOURCE: ${ document.getElementById('thirdSourceIn').value.trim() }  ${ document.getElementById('thirdSourceURLIn').value.trim() }` 
    else document.getElementById('thirdSource').textContent = ''
 
    if (document.getElementById('thirdPastedIn').value.trim()) 
        document.getElementById('thirdPasted').textContent = addQuotesTo(document.getElementById('thirdPastedIn').value.trim())
    else document.getElementById('thirdPasted').textContent = ''
 
    if (document.getElementById('thirdTextIn').value.trim()) 
        document.getElementById('thirdText').textContent = `text: ${ document.getElementById('thirdTextIn').value.trim() }`
    else document.getElementById('thirdText').textContent = ''





// baptism record
    if (document.getElementById('bapSourceIn').value.trim() || document.getElementById('bapSourceURLIn').value.trim())
        document.getElementById('bapSource').textContent = `\nSOURCE: ${ document.getElementById('bapSourceIn').value.trim() }  ${ document.getElementById('bapSourceURLIn').value.trim() }` 
    else document.getElementById('bapSource').textContent = ''
 
    if (document.getElementById('bapPastedIn').value.trim()) 
        document.getElementById('bapPasted').textContent = addQuotesTo(document.getElementById('bapPastedIn').value.trim())
    else document.getElementById('bapPasted').textContent = ''
 
    if (document.getElementById('bapTextIn').value.trim()) 
        document.getElementById('bapText').textContent = `text: ${ document.getElementById('bapTextIn').value.trim() }`
    else document.getElementById('bapText').textContent = ''
 

// harvested data

    if (document.getElementById('timestampIn').value.trim()) {
        document.getElementById('timestamp').textContent = `timestamp: "${ document.getElementById('timestampIn').value.trim() }",`
        }
    else document.getElementById('timestamp').textContent = ''

    if (document.getElementById('yearIn').value.trim())
        document.getElementById('year').textContent = `year: "${ document.getElementById('yearIn').value.trim() }",`
    else document.getElementById('year').textContent = ''

    if (document.getElementById('dateIn').value.trim())
        document.getElementById('date').textContent = `date: "${ document.getElementById('dateIn').value.trim() }",`
    else document.getElementById('date').textContent = ''

    if (document.getElementById('marrPlaceIn').value.trim()) document.getElementById('place').textContent = `place: "${ document.getElementById('marrPlaceIn').value.trim() }",` 
    else document.getElementById('place').textContent = ''

    if (document.getElementById('groomIn').value.trim()) document.getElementById('groom').textContent = `groom: "${ document.getElementById('groomIn').value.trim() }",` 
    else document.getElementById('groom').textContent = ''

    if (document.getElementById('gidIn').value.trim()) document.getElementById('gid').textContent = `gid: "${ document.getElementById('gidIn').value.trim() }",` 
    else document.getElementById('gid').textContent = ''

    if (document.getElementById('brideIn').value.trim()) document.getElementById('bride').textContent = `bride: "${ document.getElementById('brideIn').value.trim() }",` 
    else document.getElementById('bride').textContent = ''

    if (document.getElementById('bidIn').value.trim()) document.getElementById('bid').textContent = `bid: "${ document.getElementById('bidIn').value.trim() }",` 
    else document.getElementById('bid').textContent = ''

    if (document.getElementById('gageIn').value.trim()) document.getElementById('gage').textContent = `gage: "${ document.getElementById('gageIn').value.trim() }",` 
    else document.getElementById('gage').textContent = ''

    if (document.getElementById('bageIn').value.trim()) document.getElementById('bage').textContent = `bage: "${ document.getElementById('bageIn').value.trim() }",` 
    else document.getElementById('bage').textContent = ''

    if (document.getElementById('gparishIn').value.trim()) document.getElementById('gparish').textContent = `gparish: "${ document.getElementById('gparishIn').value.trim() }",` 
    else document.getElementById('gparish').textContent = ''

    if (document.getElementById('bparishIn').value.trim()) document.getElementById('bparish').textContent = `bparish: "${ document.getElementById('bparishIn').value.trim() }",` 
    else document.getElementById('bparish').textContent = ''

    if (document.getElementById('gstatusIn').value.trim()) document.getElementById('gstatus').textContent = `gstatus: "${ document.getElementById('gstatusIn').value.trim() }",` 
    else document.getElementById('gstatus').textContent = ''

    if (document.getElementById('bstatusIn').value.trim()) document.getElementById('bstatus').textContent = `bstatus: "${ document.getElementById('bstatusIn').value.trim() }",` 
    else document.getElementById('bstatus').textContent = ''

    if (document.getElementById('goccIn').value.trim()) document.getElementById('gocc').textContent = `gocc: "${ document.getElementById('goccIn').value.trim() }",` 
    else document.getElementById('gocc').textContent = ''

    if (document.getElementById('boccIn').value.trim()) document.getElementById('bocc').textContent = `bocc: "${ document.getElementById('boccIn').value.trim() }",` 
    else document.getElementById('bocc').textContent = ''



    if (document.getElementById('gfatherIn').value.trim()) document.getElementById('gfather').textContent = `gfather: "${ document.getElementById('gfatherIn').value.trim() }",` 
    else document.getElementById('gfather').textContent = ''

    if (document.getElementById('gfidIn').value.trim()) document.getElementById('gfid').textContent = `gfid: "${ document.getElementById('gfidIn').value.trim() }",` 
    else document.getElementById('gfid').textContent = ''

    if (document.getElementById('gfoccIn').value.trim()) document.getElementById('gfocc').textContent = `gfocc: "${ document.getElementById('gfoccIn').value.trim() }",` 
    else document.getElementById('gfocc').textContent = ''

    if (document.getElementById('bfatherIn').value.trim()) document.getElementById('bfather').textContent = `bfather: "${ document.getElementById('bfatherIn').value.trim() }",` 
    else document.getElementById('bfather').textContent = ''

    if (document.getElementById('bfidIn').value.trim()) document.getElementById('bfid').textContent = `bfid: "${ document.getElementById('bfidIn').value.trim() }",` 
    else document.getElementById('bfid').textContent = ''

    if (document.getElementById('bfoccIn').value.trim()) document.getElementById('bfocc').textContent = `bfocc: "${ document.getElementById('bfoccIn').value.trim() }",` 
    else document.getElementById('bfocc').textContent = ''


    if (document.getElementById('witnessesIn').value.trim()) document.getElementById('witnesses').textContent = `witnesses: "${ document.getElementById('witnessesIn').value.trim() }",` 
    else document.getElementById('witnesses').textContent = ''

    if (document.getElementById('mentionedIn').value.trim()) document.getElementById('mentioned').textContent = `mentioned: "${ document.getElementById('mentionedIn').value.trim() }",` 
    else document.getElementById('mentioned').textContent = ''

    if (document.getElementById('byIn').value.trim()) document.getElementById('by').textContent = `by: "${ document.getElementById('byIn').value.trim() }",` 
    else document.getElementById('by').textContent = ''




    if (document.getElementById('censusNotes').value) {
        document.getElementById('note').textContent = "notes: \u0060"+document.getElementById('censusNotes').value+"\u0060,"
        }


    if (document.getElementById('censusDisc').value) {
        document.getElementById('discussion').textContent = "discussion: \u0060"+document.getElementById('censusDisc').value+"\u0060,"
        }

    if (document.getElementById('cautionIn').value) {
        document.getElementById('caution').textContent = "caution: \u0060"+document.getElementById('cautionIn').value+"\u0060,"
        }









    /*if (document.getElementById('gpsIn').value.trim()) {
        lines = document.getElementById('gpsIn').value.split('\n')
        output = ''
        for (o=0;o<lines.length;o++) {
            if (lines[o].trim() === '') continue
            console.log('lines',lines[o])
            temp = lines[o].split(':')
            output += '"'+temp[0]+' https://maps.google.com/maps?q='+temp[1].replace(/ /g,'')+'"'
            if (o<lines.length-1) output += ', '
            }
        document.getElementById('gps').textContent = `gps: [${ output }],`
        }
    else document.getElementById('gps').textContent = ''*/


    if (document.getElementById('gpsIn').value.trim()) {
        lines = document.getElementById('gpsIn').value.split('\n')
        output = ''
        for (o=0;o<lines.length;o++) {
            if (lines[o].trim() === '') continue
            console.log('lines',lines[o])
            output += `"${ lines[o] }"`
            if (o<lines.length-1) output += ', '
            }
        document.getElementById('gps').textContent = `gps: [${ output }],`
        }
    else document.getElementById('gps').textContent = ''

    
    if (document.getElementById('recordsIn').value.trim()) {
        var imagesArray = []
        imagesArray = document.getElementById('recordsIn').value.split('\n')

        var imagesOut = ''
        for (i=0;i<imagesArray.length;i++) {
            if (imagesArray[i].trim() === '') continue
            parts = imagesArray[i].split(' ')
            if (imagesArray[i].match('http')) {} //
            else parts[parts.length-1] = 'url:../'+project+'_records/'+parts[parts.length-1]
            imagesOut += '"'+parts.join(' ').trim()+'"'
            if (i<imagesArray.length-1) imagesOut += ', '
            }
        if (imagesArray.length > 0) document.getElementById('images').textContent = 'images: ['+imagesOut+'],'
        }
    else document.getElementById('images').textContent = ''


    // check for timestamp
    if (document.getElementById('timestamp').textContent === '') {
        document.getElementById('timestamp').textContent = 'Add timestamp'
        document.getElementById('timestamp').style.background = 'red'
        document.getElementById('timestamp').style.color = 'white'
        }
    else {
        document.getElementById('timestamp').style.background = 'white'
        document.getElementById('timestamp').style.color = 'brown'
        }

    }


function checkDB (fieldname, dbfield, checkID) {
    // checks certain values against what currently in the top-level db, and raises flags if they differ

    thisPerson = document.getElementById('idIn').value.trim()

    if (document.getElementById(fieldname).value.trim() !== db[thisPerson][dbfield])  document.getElementById(checkID).textContent = `The database currently has ${ db[thisPerson][dbfield] }`
    else { document.getElementById(checkID).textContent = `` }

    }


function getMonthOnly (MMM) {
    // converts Jan to 01, and so on
    switch (MMM.toLowerCase()) {
        case 'jan': return '01'
        case 'feb': return '02'
        case 'mar': return '03'
        case 'apr': return '04'
        case 'may': return '05'
        case 'jun': return '06'
        case 'jul': return '07'
        case 'aug': return '08'
        case 'sep': return '09'
        case 'oct': return '10'
        case 'nov': return '11'
        case 'dec': return '12'
        default: return '???'
        }
    }

function getMonth (dateValue) {
console.log(dateValue)
    parts = dateValue.replace('~','').split(' ')
    while (parts[0].length < 2) parts[0] = '0'+parts[0]
    month = ''
    switch (parts[1].toLowerCase()) {
        case 'jan': month = '01'; break
        case 'feb': month = '02'; break
        case 'mar': month = '03'; break
        case 'apr': month = '04'; break
        case 'may': month = '05'; break
        case 'jun': month = '06'; break
        case 'jul': month = '07'; break
        case 'aug': month = '08'; break
        case 'sep': month = '09'; break
        case 'oct': month = '10'; break
        case 'nov': month = '11'; break
        case 'dec': month = '12'; break
        }
    return month+'-'+parts[0]
    }


</script></head>


<body>
<div id="out">
  <div id="banner">
    <div id="pagetitle">Marriage record entry<br>
    </div>
  </div>
  <div id="subbanner">
    <div><a href="birthentry.html">Birth</a> • <a href="censusentry.html">Census</a> • <a href="dthentry.html">Death</a></div>
  </div>
  <div id="subsubbanner">
    <div>
      <!--button onClick="dump()">Go</button-->&nbsp;
    <strong>Id:</strong> 
    
<!--input type="text" id="idIn" style="width:200px;" placeholder="Add ID, then click on 🔁."
onInput="document.getElementById('id').textContent = 'id: &quot;'+this.value+'&quot;,';"
onChange="autoPropagate(this.value);"/>

<input type="text" id="spouseIdIn" placeholder="Add ID of spouse."
        	onInput="draftResult()"-->

<input type="text" id="idIn" style="width:200px;" placeholder="Add ID, then click [LOAD]." onClick="this.select()">
<input type="text" id="spouseIdIn" placeholder="Add ID of spouse." onClick="this.select()">

<button id="load"
    title="Load from database"
    onClick="document.location=`marriageentry.html?project=${ project }&person=${ document.getElementById('idIn').value }&spouse=${ document.getElementById('spouseIdIn').value }`"
    >Load</button>



<span class="redo" onClick="autoPropagate(document.getElementById('idIn').value)">🔁</span>
<span class="redo"><a id="clearAll" href="">❌</a></span>

    
</div>
</div>
<div id="main">

<div id="references">
</div>

<div id="certificateTemplate" style="min-width: 10rem;">
<h3>Certificate</h3>
<textarea onClick="this.select()">When:&nbsp;
At:&nbsp;
Name:&nbsp;
Age:&nbsp;
Condition:&nbsp;
Rank/profession:&nbsp;
Residence:&nbsp;
Father:&nbsp;
Father occ:&nbsp;
By:&nbsp;
Signatures:&nbsp;
Witnesses:&nbsp;
Reg date:&nbsp;
Other:&nbsp;
</textarea>
</div>

<div id="parishTemplate" style="min-width: 10rem;">
<h3>Parish record</h3>
<textarea onClick="this.select()">
Marriage Date:&nbsp;
Marriage Place:&nbsp;
Groom:&nbsp;
Groom details:&nbsp;
Bride:&nbsp;
Bride details:&nbsp;
By:&nbsp;
Signatures:&nbsp;
Witnesses:&nbsp;
</textarea>
</div>


<p style="margin: 0 4rem; font-style: italic; font-size: 85%;">If you have scans of certificates or parish records, etc. point to them in the section "Record scans". • The "Source #1" and other numbered fields with expanding headings allow you to capture the information from a single source. (On a person summary page that information is revealed by clicking on a black triangle to the right.) • The fields under "Data for building the page"  contain text snippets that will be used to build the person's summary page. The data is derived from the sources, but written so that it flows well when inserted into the person's summary page.</p>


<p style="margin: 0 4rem; font-style:italic; color: teal;"><textarea id="copyIn" placeholder="Converter" style="width: 36rem; height: 4rem;"></textarea> <button onClick="doConversion()">GO</button></p>





<details id="index" open>
<summary class="heading">Source #1</summary>
<table>
    <tr>
    <td>Source:</td>
    <td>
    <input type="text" id="indexSourceIn"  class="sourceBox"
        onInput="draftResult()"
        placeholder="Source name.">
    <input type="text" id="indexSourceURLIn"  class="sourceBox"
            onInput="draftResult()" 
            placeholder="Source URL.">
    <button onClick="openWindow(document.getElementById('indexSourceURLIn').value)">GO</button>

    </td>
    </tr>
    
    <tr>
    <td>Key-value<br>pairs:<br><button 
        onClick="document.getElementById('indexPastedIn').value = tabs2colons(document.getElementById('indexPastedIn').value)">Add colons</button></td>
    <td><textarea id="indexPastedIn"  class="tallPasteBox"
        placeholder="Copy-paste lists here from transcript pages. (Each line should be [type: value]. Only lines with a colon are captured.)"
        onInput="draftResult()"></textarea></td>
    </tr>
    
    <tr>
    <td rowspan="2">Text:</td>
     <td><textarea id="indexTextIn" class="textBox" 
        placeholder="Copy-paste or write textual information here."
        onInput="draftResult()"></textarea>
        </td>
    </tr>
</table>
</details>
      
      









<details id="bap">
<summary class="heading">Source #2</summary>
<table>
<tr>
<td>Source:</td>
<td><input type="text" id="bapSourceIn" class="sourceBox"
    placeholder="Source name"
    onInput="draftResult()">
    <input type="text" id="bapSourceURLIn" class="sourceBox"
    placeholder="Source URL"
    onInput="draftResult()">
    <button onClick="openWindow(document.getElementById('bapSourceURLIn').value)">GO</button>
    </td>
</tr>

<tr>
<td>Key-value<br>pairs:<br><button 
        onClick="document.getElementById('bapPastedIn').value = tabs2colons(document.getElementById('bapPastedIn').value)">Add colons</button></td>
<td><textarea id="bapPastedIn" class="tallPasteBox"
    placeholder="Copy-paste lists here from transcript pages. (Only lines with a colon are captured.)"
    onInput="draftResult()"></textarea>
    <span class="copy" title='Remove "[...]", when copying legacy.' onClick="removeBrackets(document.getElementById('bapPastedIn'))    ">✚</span>
</td>
</tr>

<tr>
<td>Text:</td>
<td><textarea id="bapTextIn" class="textBox" 
    placeholder="Copy-paste or write textual information here.)"
    onInput="draftResult()"></textarea>
    </td>
</tr>
</table>
</details>



<script>
function removeBrackets (node) {
    // removes "[ and ]", from copied older records
    out = node.value.replace(/\]",/g,'').replace(/"\[/g,'')
    node.value = out  
    }
</script>







<details id="second">
<summary class="heading">Source #3</summary>
<table>
<tr>
<td>Source:</td>
<td><input type="text" id="secondSourceIn" class="sourceBox"
    placeholder="Source name"
    onInput="draftResult()">
    <input type="text" id="secondSourceURLIn" class="sourceBox"
    placeholder="Source URL"
    onInput="draftResult()">
    <button onClick="openWindow(document.getElementById('secondSourceURLIn').value)">GO</button>
    </td>
</tr>

<tr>
<td>Key-value<br>pairs:<br><button 
        onClick="document.getElementById('secondPastedIn').value = tabs2colons(document.getElementById('secondPastedIn').value)">Add colons</button></td>
<td><textarea id="secondPastedIn" class="tallPasteBox"
    placeholder="Copy-paste lists here from transcript pages. (Only lines with a colon are captured.)"
    onInput="draftResult()"></textarea>
    </td>
</tr>
<tr>
<td>Text:</td>
<td><textarea id="secondTextIn" class="textBox" 
    placeholder="Copy-paste or write textual information here.)"
    onInput="draftResult()"></textarea>
    </td>
</tr>
</table>
</details>









<details id="third">
<summary class="heading">Source #4</summary>
<table>
<tr>
<td>Source:</td>
<td><input type="text" id="thirdSourceIn" class="sourceBox"
    placeholder="Source name"
    onInput="draftResult()">
    <input type="text" id="thirdSourceURLIn" class="sourceBox"
    placeholder="Source URL"
    onInput="draftResult()">
    <button onClick="openWindow(document.getElementById('thirdSourceURLIn').value)">GO</button>
    </td>
</tr>

<tr>
<td>Key-value<br>pairs:<br><button 
        onClick="document.getElementById('thirdPastedIn').value = tabs2colons(document.getElementById('thirdPastedIn').value)">Add colons</button></td>
<td><textarea id="thirdPastedIn" class="tallPasteBox"
    placeholder="Copy-paste lists here from transcript pages. (Only lines with a colon are captured.)"
    onInput="draftResult()"></textarea>
    </td>
</tr>
<tr>
<td>Text:</td>
<td><textarea id="thirdTextIn" class="textBox" 
    placeholder="Copy-paste or write textual information here.)"
    onInput="draftResult()"></textarea>
    </td>
</tr>
</table>
</details>






<details open>
<summary class="heading">Record scans</summary>
<table>
<tr>
<td>Data:</td>
<td><textarea id="recordsIn" class="mediumPasteBox"
    placeholder="Add the link text you want, followed by the filename+ext. One link per line."
    onInput="draftResult()"></textarea>
</td>
</tr>
<tr>
<td>&nbsp;</td>
<td><input type="file" multiple id="getFileName" style="width:40em;" onInput="draftResult()" placeholder="A comma-separated list of filenames (no extension)"></td>
<script>
document.getElementById('getFileName').addEventListener('change', function(event) {
    const files = event.target.files
    out = ''
    for (let i = 0; i < files.length; i++) {
        if (i>0) out += '\n'
        out += files[i].name
        //console.log('File name:', files[i].name)
        }
    document.getElementById('recordsIn').value += out
    })
</script>
</tr>
<tr>
<td>Test box:</td>
<td><input type="text" id="recordTester" class="imageBox" 
    placeholder="Copy filename here & press GO to see the record.">
    <input type="text" id="recordTesterExtIn" class="extBox" value=".jpg" 
    placeholder="Extension">
    <button onClick="openRecord(document.getElementById('recordTester').value, document.getElementById('recordTesterExtIn').value)">GO</button>
    </td>
</tr>
</table>
</details>






<!-- items that get filled in by autoPropagate, but that are no longer used.
Need to fix this properly at some point. -->
<div style="display: none">
<p id="bapFatherIn"></p>
<p id="bapMotherIn"></p>
</div>



<table style="margin-inline-start: 2rem; margin-block-start: 4rem; color: teal;">
      <tr>
        <td colspan="4" class="heading">Data for building the page:</td></tr>
 
     <tr>
        <td>Timestamp:</td>
        <td colspan="3"><input type="text" id="timestampIn"
            placeholder="YYYY-MM-DD"
            onInput="draftResult()">
            </td>
      </tr>
     <tr>
        <td>Date:</td>
        <td colspan="3"><input type="text" id="dateIn"
            placeholder="DD MMM or MMM-MMM, etc."
            >
            </td>
      </tr>
     <tr>
        <td>Year:</td>
        <td colspan="3"><input type="text" id="yearIn"
            placeholder="YYYY"
            >
<script>
function makeTimestamp () {
    daymonth = document.getElementById('dateIn').value.trim()
    year = document.getElementById('yearIn').value.trim()   
    if (daymonth.match('-')) {
        switch (daymonth) {
            case 'Jan-Mar': out = "02-15"; break
            case 'Apr-Jun': out = "05-15"; break
            case 'Jul-Sep': out = "08-15"; break
            case 'Oct-Dec': out = "11-15"; break
            default: out = daymonth
            }
        document.getElementById('timestampIn').value = year+'-'+out
        } 
    else if (daymonth.match('~')) {
        daymonth = daymonth.replace(/~/,'')+' 15'
        document.getElementById('timestampIn').value = year+'-'+getMonth(daymonth)
        }
    else {
        components = daymonth.split(' ')
        document.getElementById('timestampIn').value = year+'-'+getMonth(daymonth)
        }
    }
</script>
    <!--<span class="copy" title="Add timestamp." onClick="makeTimestamp()    ">✚</span>-->
    <button class="copy" title="Add timestamp based on the marriage date." onClick="makeTimestamp()">Create time stamp</button>
            </td>
      </tr>
<tr>
<td>Marriage place:</td>
<td colspan="3"><input type="text" id="marrPlaceIn" list="gpsList"
placeholder="Place where they were married." class="wideInputBox"
onInput="draftResult()">
</td>
</tr>


<tr>
<td>Groom:</td>
<td colspan="3"><input type="text" id="groomIn"
placeholder="Groom's name." class="wideInputBox"
onInput="draftResult()">
</td>
</tr>

<tr>
<td>Groom id:</td>
<td colspan="3"><input type="text" id="gidIn"
placeholder="" class="wideInputBox"
onInput="draftResult()">
</td>
</tr>

<tr>
<td>Bride:</td>
<td colspan="3"><input type="text" id="brideIn"
placeholder="" class="wideInputBox"
onInput="draftResult()">
</td>
</tr>

<tr>
<td>Bride id:</td>
<td colspan="3"><input type="text" id="bidIn"
placeholder="" class="wideInputBox"
onInput="draftResult()">
</td>
</tr>

<tr>
<td>Groom age:</td>
<td colspan="3"><input type="text" id="gageIn"
placeholder="" class="wideInputBox"
onInput="draftResult()">
</td>
</tr>

<tr>
<td>Bride age:</td>
<td colspan="3"><input type="text" id="bageIn"
placeholder="" class="wideInputBox"
onInput="draftResult()">
</td>
</tr>

<tr>
<td>Groom residence:</td>
<td><input type="text" id="gparishIn" class="wideInputBox" onInput="draftResult()" list="gpsList"></td>
</tr>

<tr>
<td>Bride residence:</td>
<td><input type="text" id="bparishIn" class="wideInputBox" onInput="draftResult()" list="gpsList"></td>
</tr>

<tr>
<td>Groom status:</td>
<td><input type="text" id="gstatusIn" onInput="draftResult()"/></td>
</tr>

<tr>
<td>Bride status:</td>
<td><input type="text" id="bstatusIn" onInput="draftResult()"/></td>
</tr>

<tr>
<td>Groom occupation:</td>
<td><input type="text" id="goccIn" class="wideInputBox" onInput="draftResult()"/></td>
</tr>

<tr>
<td>Bride occupation:</td>
<td><input type="text" id="boccIn" class="wideInputBox" onInput="draftResult()"/></td>
</tr>


<tr>
<td>Groom father:</td>
<td><input type="text" id="gfatherIn" class="wideInputBox" onInput="draftResult()"/></td>
</tr>

<tr>
<td>Groom father id:</td>
<td><input type="text" id="gfidIn" class="wideInputBox" onInput="draftResult()"/></td>
</tr>

<tr>
<td>Groom father occ:</td>
<td><input type="text" id="gfoccIn" class="wideInputBox" onInput="draftResult()"/></td>
</tr>

<tr>
<td>Bride father:</td>
<td><input type="text" id="bfatherIn" class="wideInputBox" onInput="draftResult()"/></td>
</tr>

<tr>
<td>Bride father id:</td>
<td><input type="text" id="bfidIn" class="wideInputBox" onInput="draftResult()"></td>
</tr>
<tr>

<td>Bride father occ:</td>
<td><input type="text" id="bfoccIn" class="wideInputBox" onInput="draftResult()"></td>
</tr>

<tr>
<td>Witnesses:</td>
<td><input type="text" id="witnessesIn" class="wideInputBox" onInput="draftResult()"></td>
</tr>

<tr>
<td>Mentions:</td>
<td><input type="text" id="mentionedIn" class="wideInputBox" onInput="draftResult()" placeholder="Comma-separated list of ids for people not mentioned elsewhere."></td>
</tr>

<tr>
<td>By:</td>
<td><input type="text" id="byIn" onInput="draftResult()"/></td>
</tr>

<tr>
  <td>GPS:</td>
    <td>
    <button title="Add a template for a new place" onClick="newline = ''
        if (document.getElementById('gpsIn').value === '') {}
        else newline = '\n'
        document.getElementById('gpsIn').value += newline+`xxxx https://www.google.com/maps?q=xxx`
        draftResult()">New</button>
    <input id="findBlock" type="text" list="gpsList" placeholder="Search for known places" style="width:29em" onchange="
        newline = ''
        if (document.getElementById('gpsIn').value === '') {}
        else newline = '\n'
        document.getElementById('gpsIn').value += newline+this.value
        draftResult()
        this.value = ''">
    <datalist id="gpsList"></datalist>
    </td>
  <!--td><select id="gpsList" onChange="
            newline = ''
            if (document.getElementById('gpsIn').value === '') {}
            else newline = '\n'
            document.getElementById('gpsIn').value += newline+this.value
            draftResult()
            "></select></td-->
</tr>



    <tr>
        <td>GPS:</td>
        <td colspan="3"><textarea id="gpsIn" onInput="draftResult()" placeholder="Use the selection control above or type directly to add locations here, one per line. The end result should look like this: Blakemore Gate https://www.google.com/maps?q=52.6040598,-2.9199274"></textarea></td>
      </tr>

    <tr>
        <td>Notes:</td>
        <td colspan="3"><textarea id="censusNotes" onInput="draftResult()"></textarea></td>
      </tr>
      <tr>
        <td>FNotes:</td>
        <td colspan="3"><textarea id="censusFNotes" onInput="makeNotes(this.value,'fnote')"></textarea></td>
      </tr>
      <tr>
        <td>Discussion:</td>
        <td colspan="3"><textarea id="censusDisc" onInput="draftResult()"></textarea></td>
      </tr>
      <tr>
        <td>Caution:</td>
        <td colspan="3"><textarea id="cautionIn" onInput="draftResult()"></textarea></td>
      </tr>
   </table>
   
   
<!--p class="" style="margin: 4rem 0 0 2rem; font-style:italic; color: teal;"><textarea id="copyIn" placeholder="Converter"></textarea> <button onClick="doConversion()">GO</button></p-->
   
   <script>
   // drop OLD data into the textarea and click GO
   // this function finds stuff to put in the page building data list
   function doConversion () {
        lines = document.getElementById('copyIn').value.split('\n')
        for (i=0;i<lines.length;i++) {
            lines[i] = lines[i].trim().replace(/"/g,'')
            if (lines[i] === '') continue
            console.log(lines[i])
            
            if (lines[i].startsWith('year:')) outId = 'yearIn'
            
            else if (lines[i].startsWith('date:')) outId = 'dateIn'
            
            else if (lines[i].startsWith('place:')) outId = 'marrPlaceIn'
            
            else if (lines[i].startsWith('groom:')) outId = 'groomIn'
            
            else if (lines[i].startsWith('gid:')) outId = 'gidIn'
            
            else if (lines[i].startsWith('bride:')) outId = 'brideIn'
            
            else if (lines[i].startsWith('bid:')) outId = 'bidIn'
            
            else if (lines[i].startsWith('gage:')) outId = 'gageIn'
            
            else if (lines[i].startsWith('bage:')) outId = 'bageIn'
            
            else if (lines[i].startsWith('gparish:')) outId = 'gparishIn'
            
            else if (lines[i].startsWith('bparish:')) outId = 'bparishIn'
            
            else if (lines[i].startsWith('gstatus:')) outId = 'gstatusIn'
            
            else if (lines[i].startsWith('bstatus:')) outId = 'bstatusIn'
            
            else if (lines[i].startsWith('bocc:')) outId = 'boccIn'
            
            else if (lines[i].startsWith('gocc:')) outId = 'goccIn'
            
            else if (lines[i].startsWith('gfather:')) outId = 'gfatherIn'
            
            else if (lines[i].startsWith('gfid:')) outId = 'gfidIn'
            
            else if (lines[i].startsWith('gfocc:')) outId = 'gfoccIn'
            
            else if (lines[i].startsWith('bfather:')) outId = 'bfatherIn'
            
            else if (lines[i].startsWith('bfid:')) outId = 'bfidIn'
            
            else if (lines[i].startsWith('bfocc:')) outId = 'bfoccIn'
            
            else if (lines[i].startsWith('witnesses:')) outId = 'witnessesIn'
            
            else if (lines[i].startsWith('mentioned:')) outId = 'mentionedIn'
            
            else if (lines[i].startsWith('by:')) outId = 'byIn'
            
            else outId = ''
            
            value = lines[i].split(':')
            if (outId) document.getElementById(outId).value = value[1].replace(/,$/,'').trim()
            console.log(value[1].replace(/,$/,'').trim())
            }


        // create the timestamp
        if (document.getElementById('dateIn').value !== '' && document.getElementById('yearIn').value !== '') document.getElementById('timestampIn').value = document.getElementById('yearIn').value+'-'+getMonth(document.getElementById('dateIn').value)
        }
    
    function getMonth (dateValue) {
        parts = dateValue.replace('~','').split(' ')
        while (parts[0].length < 2) parts[0] = '0'+parts[0]
        month = ''
        switch (parts[1]) {
            case 'Jan': month = '01'; break
            case 'Feb': month = '02'; break
            case 'Mar': month = '03'; break
            case 'Apr': month = '04'; break
            case 'May': month = '05'; break
            case 'Jun': month = '06'; break
            case 'Jul': month = '07'; break
            case 'Aug': month = '08'; break
            case 'Sep': month = '09'; break
            case 'Oct': month = '10'; break
            case 'Nov': month = '11'; break
            case 'Dec': month = '12'; break
            }
        return month+'-'+parts[0]
        }
   </script>
    
    
    <!--<p style="text-align: center;"><button style="font-size: 2rem; background-color: antiquewhite; border-radius: 1rem; padding-inline: .5rem; box-shadow: none; border: 1px solid beige;" onClick="draftResult();">Generate data</button></p>-->

    <p class="" style="margin: 4rem 0 0 2rem; font-style:italic; color: teal;">When all the data is entered, copy the text below to the db.js file, under 'marriage'.</p>

    <div title="Copy data to clipboard" style="margin-block-start: 2rem; text-align: center; font-size: 2rem; background-color: antiquewhite; border-radius: 1rem; padding-inline: .5rem; box-shadow: none; border: 1px solid beige; cursor: pointer;" 
    onclick="draftResult(); console.log(prepCopy()); navigator.clipboard.writeText(prepCopy()); document.getElementById('copyNotice').style.display = 'block'; setTimeout(() => { document.getElementById('copyNotice').style.display = 'none' }, '500')">Copy
    <img src="../../lib/i/copytiny.svg" alt="" style="height:1em; width:1em; vertical-align: middle;">
    </div>
   
   
<div id="draft" contenteditable style="margin:2rem; color: brown;">
<!--div id="start">marriages: {</div-->
      <div id="spouseId">: {</div>

      <div id="timestamp"></div>
      <div id="year"></div>
      <div id="date"></div>
      <div id="place"></div>
      <div id="id"></div>
      <div id="groom"></div>
      <div id="gid"></div>
      <div id="bride"></div>
      <div id="bid"></div>
      <div id="gage"></div>
      <div id="bage"></div>
      <div id="gparish"></div>
      <div id="bparish"></div>
      <div id="gstatus"></div>
      <div id="bstatus"></div>
      <div id="gocc"></div>
      <div id="bocc"></div>
     
      <div id="gfather"></div>
      <div id="gfid"></div>
      <div id="gfocc"></div>
      <div id="bfather"></div>
      <div id="bfid"></div>
      <div id="bfocc"></div>
      
      <div id="witnesses"></div>
      <div id="mentioned"></div>
      <div id="by"></div>
      <div id="length"></div>







<div id="images"></div>
<div id="gps"></div>

<div id="note" style="white-space: pre;"></div>
<div id="fnote"></div>
<div id="discussion" style="white-space: pre;"></div>
<div id="caution" style="white-space: pre;"></div>

<div style="white-space:pre-line">sources: `</div>

<!-- index -->
<div id="indexSource" style="white-space: pre;"></div>
<div id="indexText" style="white-space: pre;"></div>
<div id="indexName"></div>
<div id="indexPasted" style="white-space:pre-line"></div>
<div id="marriageRecord"></div>

<!-- baptism -->
<div id="bapSource" style="white-space: pre;"></div>
<div id="bapImage"></div>
<div id="bapParish"></div>
<div id="bapBorn"></div>
<div id="bapName"></div>
<div id="bapFather"></div>
<div id="bapMother"></div>
<div id="bapAbode"></div>
<div id="bapOcc"></div>
<div id="bapText"></div>
<div id="bapPasted" style="white-space:pre-line"></div>


<!-- 2nd source -->
<div id="secondSource" style="white-space: pre;"></div>
<div id="secondImage"></div>
<div id="secondPasted" style="white-space:pre-line"></div>
<div id="secondText" style="white-space:pre-line"></div>

<!-- 3rd source -->
<div id="thirdSource" style="white-space: pre;"></div>
<div id="thirdImage"></div>
<div id="thirdPasted" style="white-space:pre-line"></div>
<div id="thirdText" style="white-space:pre-line"></div>

<div id="arrayEnd">`},</div>
<!--div id="end">},</div-->




</div>
      



<script>
document.getElementById('idIn').value = theperson
document.getElementById('spouseIdIn').value = spouse
console.log(document.getElementById('idIn').value)


function prepCopy () {
    var draft, copied, divs
    
    draft = document.getElementById('draft')
    copied = ''
    divs = draft.querySelectorAll('div')
    for (i=0;i<divs.length;i++) {
        if (divs[i].textContent.trim() !== '') copied += divs[i].textContent+'\n'
        }
    return copied
    }



function prepCopyX () {
    draft = document.getElementById('draft')
    copied = document.getElementById('draftCopy')
    copied.value = ''
    divs = draft.querySelectorAll('div')
    for (i=0;i<divs.length;i++) {
        if (divs[i].textContent.trim() !== '') copied.value += divs[i].textContent+'\n'
        }
    copied.focus()
    copied.select()
    document.execCommand('copy')
    return false
    }
</script>
    <!--<p style="text-align: center;"><button style="font-size: 1.5rem; background-color: antiquewhite; border-radius: 1rem; padding-inline: .5rem; box-shadow: none; border: 1px solid beige;" onClick="draftResult();">Regenerate to include timestamp</button></p>-->

<!--<div style="text-align: center;"><button  style="font-size: 2rem;" onClick="prepCopy()">Copy</button> <textarea style="block-size:2rem;inline-size:1rem; vertical-align: bottom;" id="draftCopy"></textarea></div>-->


    <pre id="places">
    </pre>
  </div>
</div>

<dialog id="copyNotice">Copied !</dialog>

<script>
document.getElementById('clearAll').href = document.location
</script>
</body>
</html>