<!doctype html>
<html>
<head>
<meta charset="UTF-8">
<title>Check DB for duplicates</title>
<link href="../lib/style.css" rel="stylesheet">
<script src="../all/db.js" type="application/javascript"></script>
</head>
<body>
<div id="outx">
  <div id="banner">
    <div id="pagetitle">Check DB for duplicates<br>
      <span id="bannerdates">&nbsp;</span></div>
  </div>
  <div id="subbanner">
    <div><a href="#n1">Foundation</a> • <a href="#n2">MORE PHOTOS</a> • <a href="#n3">Graveyard plan</a></div>
  </div>
  <div id="subsubbanner">
    <div>
      <button onClick="checkit()">Go</button>
    </div>
  </div>
  <div id="main">
    <div class="dateAndRecord" id="list">
      <div class="record">
      
      
      <textarea id="out" style="width: 100%; height: 900px;"></textarea>
      
      </div>
    </div>
    <pre id="places">
    </pre>
  </div>
</div>

<script>

function checkit () {
    out = 'Duplicates\n'
    check = new Set([])
    count = 0

    dump = document.getElementById('out').value
    const regex = /\n[a-z_]+[^:]+:\{/g
    //const regex = /Brant/g
    found = dump.match(regex)

    console.log(found)
    
    for (i=0;i<found.length;i++) {
        if (check.has(found[i]) && found[i] !== '\nevents:{' && found[i] !== '\nmarriages:{') {
            out += found[i]+'\n'
            }
        check.add(found[i])
        count++
        }

    if (out === 'Duplicates\n') document.getElementById('out').value = out+'None. \n'+count+' records checked'
    else document.getElementById('out').value = out+'\n'+count+' records checked'
    }



/*
for (r in db) {
    console.log(r)
    if (check.has(r)) {
        out += r+'\n'
        }
    check.add(r)
    count++
    }

if (out === 'Duplicates\n') document.getElementById('out').value = out+'None. '+count+' records checked'
else document.getElementById('out').value = out+', '+count+' records checked'
*/
</script>

</body>
</html>